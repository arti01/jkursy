<?xml version='1.0' encoding='UTF-8' ?>
<!DOCTYPE composition PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:h="http://java.sun.com/jsf/html"
      xmlns:fn="http://java.sun.com/jsp/jstl/functions"
      xmlns:ui="http://java.sun.com/jsf/facelets"
      xmlns:rich="http://richfaces.org/rich">
    <h:outputStylesheet library="css" name="../resources/css/default.css"/>
    <h:form>
        <h4>Menu</h4>
        <table
            style="width: 100%; font-size: 12px; font-family: arial, tahoma;" cellpadding="1" cellspacing="0">
            <tr>
                <td width="100%">
                    <rich:panelMenu itemMode="client" groupMode="ajax" groupExpandedLeftIcon="triangleUp"
                                    groupCollapsedLeftIcon="triangleDown" topGroupExpandedRightIcon="chevronUp"
                                    topGroupCollapsedRightIcon="chevronDown" itemLeftIcon="disc">
                        <rich:panelMenuGroup id="pgSt" label="Struktura organizacyjna" rendered="#{login.struktura}" expanded="#{login.menuStrukturaExp}" actionListener="#{login.menuStrukturaExpList}">
                            <h:commandLink action="#{UsersM.nowy}">
                                <rich:panelMenuItem >
                                    Nowy pracownik
                                </rich:panelMenuItem>
                            </h:commandLink>

                            <h:commandLink action="#{UsersM.lista}" >
                                <rich:panelMenuItem>
                                    Lista pracowników
                                </rich:panelMenuItem>
                            </h:commandLink>

                            <h:commandLink action="#{StruktOsM.lista}" >
                                <rich:panelMenuItem>
                                    Struktura osobowa
                                </rich:panelMenuItem>
                            </h:commandLink>

                            <h:commandLink action="#{StruktDzialM.lista}" >
                                <rich:panelMenuItem>
                                    Struktura działów
                                </rich:panelMenuItem>
                            </h:commandLink>
                            
                            <h:commandLink action="#{RodzUrlopMg.list}" >
                                <rich:panelMenuItem>
                                    Rodzaje Urlopów
                                </rich:panelMenuItem>
                            </h:commandLink>
                        </rich:panelMenuGroup>


                        <h:commandLink action="#{SpolkiMg.list}" rendered="#{login.admin}">
                            <rich:panelMenuItem>
                                Zarządzanie spółkami
                            </rich:panelMenuItem>
                        </h:commandLink>

                        <h:commandLink action="#{UsersM.ustawZastepce}"  rendered="#{login.musZast}">
                            <rich:panelMenuItem>
                                Ustaw swojego zastępcę
                            </rich:panelMenuItem>
                        </h:commandLink>

                        <h:commandLink action="#{UrlopAll.list}" rendered="#{login.admin}">
                            <rich:panelMenuItem >
                                Lista wszystkich wniosków
                            </rich:panelMenuItem>
                        </h:commandLink>

                        <rich:panelMenuGroup label="Obsługa urlopów" rendered="#{login.urlop}" expanded="#{login.menuUrlopExp}" actionListener="#{login.menuUrlopExpList}">
                            <h:commandLink action="#{UrlopM.list}" >
                                <rich:panelMenuItem>
                                    Twoje wnioski
                                </rich:panelMenuItem>
                            </h:commandLink>

                            <h:commandLink action="#{UrlopM.listPodwl}" rendered="#{login.zalogowany.stKier or fn:length(login.zalogowany.userId.strukturaSec)>0}" >
                                <rich:panelMenuItem >
                                    Wnioski do akceptacji
                                </rich:panelMenuItem>
                            </h:commandLink>

                            <h:commandLink action="#{UrlopM.listPodwlHist}" rendered="#{login.zalogowany.stKier}">
                                <rich:panelMenuItem >
                                    Historia wniosków
                                </rich:panelMenuItem>
                            </h:commandLink>

                            <h:commandLink action="#{UrlopObceM.list}" rendered="#{login.zalogowany.przyjmowanieWnioskow}">    
                                <rich:panelMenuItem >
                                    Obce wnioski
                                </rich:panelMenuItem>
                            </h:commandLink>
                        </rich:panelMenuGroup>

                        <h:commandLink action="#{login.htmlZmianaHasla}" rendered="#{(login.zalogowany.userId.extId=='' or fn:contains(login.zalogowany.userId.extId, '@') or fn:contains(login.zalogowany.userId.extId, 'FN')) 
                                                 and login.zalogowany!=null}">
                            <rich:panelMenuItem >
                                Zmiana hasła
                            </rich:panelMenuItem>
                        </h:commandLink>
                        <rich:panelMenuItem>
                            <h:outputLink value="../logowanie/logout.jsp">
                                Wyjście
                            </h:outputLink>
                        </rich:panelMenuItem>


                        <rich:panelMenuItem>
                            Zalogowany jako: #{login.zalogowany.userId.fullname}, <br/>spółka: #{login.zalogowany.userId.spolkaId.nazwa}
                        </rich:panelMenuItem>
                        <rich:panelMenuItem rendered="#{fn:length(login.zalogowany.userId.wnLimity.ulimit)!=0}">
                            Dostępny urlop:<br/>
                            <strong>#{login.zalogowany.userId.wnLimity.ulimit}</strong>
                        </rich:panelMenuItem>
                    </rich:panelMenu>
                </td>
            </tr>
        </table>

        <h:panelGroup rendered="#{fn:length(login.menuLinki)>0}">
            <h4>do pobrania</h4>
            <ul>
                <ui:repeat value="#{login.menuLinki}" var="menuLinki">
                    <li><rich:panel>
                            <h:outputLink value="#{menuLinki.link}">
                                <h:outputText value="#{menuLinki.nazwa}"/>
                            </h:outputLink>
                            <rich:tooltip id="tt1" layout="block">
                                <h:outputText value="#{menuLinki.opis}"/>
                            </rich:tooltip>
                        </rich:panel>
                    </li>
                </ui:repeat>
            </ul>
        </h:panelGroup>

    </h:form>
</html>